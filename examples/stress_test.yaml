tosca_definitions_version: cloudify_dsl_1_3

imports:
  - http://www.getcloudify.org/spec/cloudify/3.4/types.yaml
  - http://www.getcloudify.org/spec/openstack-plugin/1.5/plugin.yaml
  - http://www.getcloudify.org/spec/diamond-plugin/1.3.3/plugin.yaml
  - types/clearwater.yaml


node_templates:

  stress_test_host:
    type: cloudify.openstack.nodes.Server
    properties:
      cloudify_agent:
       user: ubuntu
      server:
        image: 9d25fe2d-cf31-4b05-8c58-f238ec78e633 # Ubuntu Server 14.04.1 LTS
        flavor: 101

  stress_test:
    type: clearwater.nodes.stress-test
    relationships:
      - type: cloudify.relationships.contained_in
        target: stress_test_host
      - type: cloudify.relationships.depends_on
        target: homer_bulk_number
      - type: cloudify.relationships.depends_on
        target: homestead_bulk_number

  homer_host:
    type: cloudify.nodes.Compute
    properties:
      cloudify_agent:
        ip:
        key:

  homer_bulk_number:
    type: clearwater.nodes.bulknumber.homer
    properties:
      name: users
      homestead_ip:
    relationships:
      cloudify.interfaces.relationship_lifecycle:
        - type: cloudify.relationships.contained_in
          target: homer_host

  homestead_host:
    type: cloudify.nodes.Compute
    properties:
      cloudify_agent:
        ip:
        key:

  homestead_bulk_number:
    type: clearwater.nodes.bulknumber.homestead
    properties:
      name: users
    relationships:
      cloudify.interfaces.relationship_lifecycle:
        - type: cloudify.relationships.contained_in
          target: homestead_host